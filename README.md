# ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¦ç´„ã®é”äºº - ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ

Microsoft 365 Copilot ã® **Declarative Agentï¼ˆå®£è¨€å‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼‰** ã¨ **Connected Agentsï¼ˆæ¥ç¶šã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼‰æ©Ÿèƒ½** ã‚’æ´»ç”¨ã—ãŸã€è¤‡æ•°ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé€£æºã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚

---

## ç›®æ¬¡

1. [æ¦‚è¦](#æ¦‚è¦)
2. [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
3. [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ](#ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ)
4. [å„ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²](#å„ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²)
5. [ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †](#ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †)
6. [æ‹¡å¼µæ–¹æ³•](#æ‹¡å¼µæ–¹æ³•)
7. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)
8. [å‚è€ƒãƒªãƒ³ã‚¯](#å‚è€ƒãƒªãƒ³ã‚¯)

---

## æ¦‚è¦

### ã“ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ç›®çš„

ä¼šè­°ã®ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆæ–‡å­—èµ·ã“ã—ï¼‰ã‚’ã€ä»¥ä¸‹ã®2æ®µéšã§å‡¦ç†ã—ã¾ã™ï¼š

| ãƒ•ã‚§ãƒ¼ã‚º | å‡¦ç†å†…å®¹ | æ‹…å½“ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ |
|---------|---------|----------------|
| **ãƒ•ã‚§ãƒ¼ã‚º1** | ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æ•´å½¢ï¼ˆè©±è€…åˆ†é›¢ã€å°‚é–€ç”¨èªè£œæ­£ï¼‰ | ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆæ•´å½¢ãã‚“ |
| **ãƒ•ã‚§ãƒ¼ã‚º2** | ç”¨é€”ã«å¿œã˜ãŸè¦ç´„ç”Ÿæˆ | MTGè­°äº‹éŒ²ãã‚“ / è³ªç–‘å¿œç­”ãã‚“ / ã‚¹ãƒ©ã‚¤ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ãã‚“ |

### Connected Agentsæ©Ÿèƒ½ã¨ã¯

Microsoft 365 Copilotã®æ©Ÿèƒ½ã§ã€**ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**ãŒè¤‡æ•°ã®**ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**ã‚’å‘¼ã³å‡ºã—ã¦é€£æºå‡¦ç†ã‚’è¡Œã†ä»•çµ„ã¿ã§ã™ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ãƒ¦ãƒ¼ã‚¶ãƒ¼                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¦ç´„ã®é”äººï¼ˆã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ï¼‰        â”‚
â”‚                   æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â–¼                   â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚æ•´å½¢ãã‚“      â”‚    â”‚è­°äº‹éŒ²ãã‚“    â”‚    â”‚è³ªç–‘å¿œç­”ãã‚“  â”‚
â”‚(WORKER_1)   â”‚    â”‚(WORKER_2)   â”‚    â”‚(WORKER_3)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚ã‚¹ãƒ©ã‚¤ãƒ‰      â”‚
                           â”‚ãƒ¬ãƒ“ãƒ¥ãƒ¼ãã‚“   â”‚
                           â”‚(WORKER_4)   â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### Declarative Agentï¼ˆå®£è¨€å‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼‰ã®æ§‹é€ 

```
App Package (ZIP)
â”œâ”€â”€ manifest.json           â† Microsoft 365 ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ç™»éŒ²æƒ…å ±
â”œâ”€â”€ declarativeAgent.json   â† ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å‹•ä½œå®šç¾©
â”œâ”€â”€ instruction.txt         â† ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼ˆLLMã¸ã®æŒ‡ç¤ºï¼‰
â”œâ”€â”€ color.png              â† ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆã‚«ãƒ©ãƒ¼ç‰ˆï¼‰
â””â”€â”€ outline.png            â† ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ç‰ˆï¼‰
```

### å‡¦ç†ãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant U as ãƒ¦ãƒ¼ã‚¶ãƒ¼
    participant O as ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼
    participant W1 as æ•´å½¢ãã‚“
    participant W2 as è­°äº‹éŒ²ãã‚“

    U->>O: ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ« + è£œè¶³æƒ…å ±
    O->>W1: æ•´å½¢ä¾é ¼
    W1-->>O: æ•´å½¢çµæœï¼ˆåˆ†å‰²å‡ºåŠ›ï¼‰
    O-->>U: æ•´å½¢çµæœã‚’è¡¨ç¤º
    U->>O: ã€Œç¶šãã€
    O->>W1: ç¶šãã®è¦æ±‚
    W1-->>O: ç¶šãã®æ•´å½¢çµæœ
    O-->>U: ç¶šãã‚’è¡¨ç¤º
    U->>O: ã€ŒMTGè­°äº‹éŒ²è¦ç´„ã€
    O->>W2: è¦ç´„ä¾é ¼ï¼ˆå…¨æ•´å½¢ãƒ†ã‚­ã‚¹ãƒˆï¼‰
    W2-->>O: è­°äº‹éŒ²å½¢å¼ã®è¦ç´„
    O-->>U: è¦ç´„ã‚’è¡¨ç¤º
```

---

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆ/
â”œâ”€â”€ ğŸ“ appPackage/                    # ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®šç¾©ï¼ˆã‚³ã‚¢ï¼‰
â”‚   â”œâ”€â”€ manifest.json                 # ã‚¢ãƒ—ãƒªãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ declarativeAgent.json         # ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè¨­å®š
â”‚   â”œâ”€â”€ instruction.txt               # ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
â”‚   â”œâ”€â”€ color.png                     # ã‚«ãƒ©ãƒ¼ã‚¢ã‚¤ã‚³ãƒ³
â”‚   â”œâ”€â”€ outline.png                   # ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ã‚¢ã‚¤ã‚³ãƒ³
â”‚   â””â”€â”€ ğŸ“ build/                     # ãƒ“ãƒ«ãƒ‰æˆæœç‰©ï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰
â”‚
â”œâ”€â”€ ğŸ“ env/                           # ç’°å¢ƒå¤‰æ•°
â”‚   â”œâ”€â”€ .env.local                    # ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç”¨ï¼ˆgitignoreï¼‰
â”‚   â”œâ”€â”€ .env.local.user               # ãƒ­ãƒ¼ã‚«ãƒ«ç”¨ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆï¼ˆgitignoreï¼‰
â”‚   â”œâ”€â”€ .env.dev                      # é–‹ç™ºç’°å¢ƒç”¨
â”‚   â””â”€â”€ .env.dev.user                 # é–‹ç™ºç’°å¢ƒç”¨ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆï¼ˆgitignoreï¼‰
â”‚
â”œâ”€â”€ ğŸ“ .vscode/                       # VS Codeè¨­å®š
â”‚   â”œâ”€â”€ launch.json                   # ãƒ‡ãƒãƒƒã‚°æ§‹æˆ
â”‚   â”œâ”€â”€ tasks.json                    # ã‚¿ã‚¹ã‚¯å®šç¾©
â”‚   â”œâ”€â”€ settings.json                 # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š
â”‚   â”œâ”€â”€ mcp.json                      # MCPã‚µãƒ¼ãƒãƒ¼è¨­å®š
â”‚   â””â”€â”€ extensions.json               # æ¨å¥¨æ‹¡å¼µæ©Ÿèƒ½
â”‚
â”œâ”€â”€ ğŸ“ .github/                       # GitHubè¨­å®š
â”‚   â””â”€â”€ copilot-instructions.md       # GitHub Copilotç”¨æŒ‡ç¤º
â”‚
â”œâ”€â”€ m365agents.yml                    # ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°è¨­å®šï¼ˆé–‹ç™º/æœ¬ç•ªï¼‰
â”œâ”€â”€ m365agents.local.yml              # ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°è¨­å®šï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰
â”œâ”€â”€ .gitignore                        # Gité™¤å¤–è¨­å®š
â””â”€â”€ README.md                         # æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
```

---

## å„ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²

### ğŸ”· `appPackage/manifest.json` - ã‚¢ãƒ—ãƒªãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ

Microsoft 365 ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã¸ã®ã‚¢ãƒ—ãƒªç™»éŒ²æƒ…å ±ã‚’å®šç¾©ã—ã¾ã™ã€‚

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | èª¬æ˜ | æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®š |
|-----------|------|---------------------|
| `$schema` | ã‚¹ã‚­ãƒ¼ãƒãƒãƒ¼ã‚¸ãƒ§ãƒ³ | v1.24 |
| `id` | ã‚¢ãƒ—ãƒªIDï¼ˆç’°å¢ƒå¤‰æ•°ã‹ã‚‰æ³¨å…¥ï¼‰ | `${{TEAMS_APP_ID}}` |
| `name.short` | è¡¨ç¤ºå | ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¦ç´„ã®é”äºº |
| `copilotAgents` | Copilotã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®šç¾© | declarativeAgent.jsonã‚’å‚ç…§ |

```json
{
  "copilotAgents": {
    "declarativeAgents": [{
      "id": "declarativeAgent",
      "file": "declarativeAgent.json"  // â† ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
    }]
  }
}
```

### ğŸ”· `appPackage/declarativeAgent.json` - ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè¨­å®š

ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å‹•ä½œã‚’å®šç¾©ã™ã‚‹ã‚³ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | èª¬æ˜ | æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®š |
|-----------|------|---------------------|
| `$schema` | ã‚¹ã‚­ãƒ¼ãƒãƒãƒ¼ã‚¸ãƒ§ãƒ³ | v1.6 |
| `instructions` | ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ | instruction.txtã‚’å‚ç…§ |
| `conversation_starters` | ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ | 4ã¤ã®å‡¦ç†ã‚’å®šç¾© |
| `worker_agents` | æ¥ç¶šã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ | 4ã¤ã®ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚’å®šç¾© |

```json
{
  "instructions": "$[file('instruction.txt')]",
  "conversation_starters": [
    { "title": "ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ•´å½¢", "text": "..." },
    { "title": "MTGè­°äº‹éŒ²è¦ç´„", "text": "..." }
  ],
  "worker_agents": [
    { "id": "${{WORKER_AGENT_1_TITLE_ID}}" },  // æ•´å½¢ãã‚“
    { "id": "${{WORKER_AGENT_2_TITLE_ID}}" },  // è­°äº‹éŒ²ãã‚“
    { "id": "${{WORKER_AGENT_3_TITLE_ID}}" },  // è³ªç–‘å¿œç­”ãã‚“
    { "id": "${{WORKER_AGENT_4_TITLE_ID}}" }   // ã‚¹ãƒ©ã‚¤ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ãã‚“
  ]
}
```

### ğŸ”· `appPackage/instruction.txt` - ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ

LLMã¸ã®æŒ‡ç¤ºã‚’è¨˜è¿°ã—ã¾ã™ã€‚æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ä»¥ä¸‹ã‚’å®šç¾©ï¼š

- **å½¹å‰²å®šç¾©**: æƒ…å ±ã®ã€Œæ©‹æ¸¡ã—ã€å½¹ï¼ˆç·¨é›†ç¦æ­¢ï¼‰
- **ãƒ•ã‚§ãƒ¼ã‚º1**: ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆæ•´å½¢ãƒ•ãƒ­ãƒ¼
- **ãƒ•ã‚§ãƒ¼ã‚º2**: è¦ç´„å‡¦ç†ãƒ•ãƒ­ãƒ¼
- **ãƒ«ãƒ¼ãƒ«**: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå‡ºåŠ›ã®ç„¡ç·¨é›†è»¢é€

### ğŸ”· `env/.env.dev` - ç’°å¢ƒå¤‰æ•°ï¼ˆé–‹ç™ºç’°å¢ƒï¼‰

```env
# ç’°å¢ƒè­˜åˆ¥
TEAMSFX_ENV=dev
APP_NAME_SUFFIX=dev
AGENT_SCOPE=shared

# è‡ªå‹•ç”ŸæˆIDï¼ˆProvisionæ™‚ã«è¨­å®šï¼‰
TEAMS_APP_ID=2f1929bc-...
M365_TITLE_ID=T_a4e6dbd8-...

# â˜… ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆIDï¼ˆæ‰‹å‹•è¨­å®šãŒå¿…è¦ï¼‰
WORKER_AGENT_1_TITLE_ID=T_47bdc189-...  # æ•´å½¢ãã‚“
WORKER_AGENT_2_TITLE_ID=T_35e2f1f3-...  # è­°äº‹éŒ²ãã‚“
WORKER_AGENT_3_TITLE_ID=T_268c0d56-...  # è³ªç–‘å¿œç­”ãã‚“
WORKER_AGENT_4_TITLE_ID=T_8f150434-...  # ã‚¹ãƒ©ã‚¤ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ãã‚“
```

### ğŸ”· `m365agents.yml` / `m365agents.local.yml` - ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°è¨­å®š

Infrastructure as Code ã¨ã—ã¦ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †ã‚’å®šç¾©ã—ã¾ã™ã€‚

| ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ | èª¬æ˜ |
|-----------|------|
| `teamsApp/create` | Developer Portalã«ã‚¢ãƒ—ãƒªä½œæˆ |
| `teamsApp/zipAppPackage` | appPackageã‚’ZIPåŒ– |
| `teamsApp/validateAppPackage` | ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ¤œè¨¼ |
| `teamsApp/update` | Developer Portalã«åæ˜  |
| `teamsApp/extendToM365` | Microsoft 365å…¨ä½“ã«å±•é–‹ |
| `teamsApp/publishAppPackage` | ç®¡ç†ã‚»ãƒ³ã‚¿ãƒ¼ã«å…¬é–‹ç”³è«‹ |

**ãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆã¨ã®é•ã„:**

| é …ç›® | `m365agents.yml` | `m365agents.local.yml` |
|------|------------------|------------------------|
| `AGENT_SCOPE` | `shared`ï¼ˆçµ„ç¹”å…±æœ‰ï¼‰ | ãªã—ï¼ˆå€‹äººã®ã¿ï¼‰ |
| `publish`ã‚»ã‚¯ã‚·ãƒ§ãƒ³ | ã‚ã‚Š | ãªã— |

---

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### å‰ææ¡ä»¶

- [Node.js](https://nodejs.org/) v18/20/22
- [Microsoft 365 Agents Toolkit](https://marketplace.visualstudio.com/items?itemName=TeamsDevApp.ms-teams-vscode-extension) v5.0.0ä»¥ä¸Š
- [Microsoft 365 Copilot ãƒ©ã‚¤ã‚»ãƒ³ã‚¹](https://learn.microsoft.com/microsoft-365-copilot/extensibility/prerequisites)
- **ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ4ã¤ï¼ˆäº‹å‰ãƒ‡ãƒ—ãƒ­ã‚¤æ¸ˆã¿ï¼‰**

### æ‰‹é †

#### 1. ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®Title IDå–å¾—

å„ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’Provisionå¾Œã€ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã§å–å¾—ï¼š

- Provisionå®Ÿè¡Œæ™‚ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›
- `env/.env.*.user` ãƒ•ã‚¡ã‚¤ãƒ«å†…ã® `M365_TITLE_ID`
- [ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼ãƒ¢ãƒ¼ãƒ‰](https://learn.microsoft.com/microsoft-365-copilot/extensibility/debugging-agents-copilot-studio)ã§ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç¢ºèª

#### 2. ç’°å¢ƒå¤‰æ•°è¨­å®š

`env/.env.dev` ã«ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®Title IDã‚’è¨­å®šï¼š

```env
WORKER_AGENT_1_TITLE_ID=T_xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
WORKER_AGENT_2_TITLE_ID=T_xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
WORKER_AGENT_3_TITLE_ID=T_xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
WORKER_AGENT_4_TITLE_ID=T_xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
```

#### 3. ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°å®Ÿè¡Œ

VS Codeã§:
1. Microsoft 365 Agents Toolkit ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
2. Accountã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã‚µã‚¤ãƒ³ã‚¤ãƒ³
3. `Preview Local in Copilot (Edge)` ã¾ãŸã¯ `(Chrome)` ã‚’å®Ÿè¡Œ

---

## æ‹¡å¼µæ–¹æ³•

### 1. ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®è¿½åŠ 

```json
// filepath: appPackage/declarativeAgent.json
{
  // ...existing code...
  "worker_agents": [
    { "id": "${{WORKER_AGENT_1_TITLE_ID}}" },
    { "id": "${{WORKER_AGENT_2_TITLE_ID}}" },
    { "id": "${{WORKER_AGENT_3_TITLE_ID}}" },
    { "id": "${{WORKER_AGENT_4_TITLE_ID}}" },
    { "id": "${{WORKER_AGENT_5_TITLE_ID}}" }  // æ–°è¦è¿½åŠ 
  ]
}
```

```env
// filepath: env/.env.dev
// ...existing code...
WORKER_AGENT_5_TITLE_ID=T_æ–°ã—ã„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®TitleID
```

### 2. ä¼šè©±ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã®è¿½åŠ 

```json
// filepath: appPackage/declarativeAgent.json
{
  // ...existing code...
  "conversation_starters": [
    // ...existing code...
    {
      "title": "ã‚¢ã‚¯ã‚·ãƒ§ãƒ³æŠ½å‡º",
      "text": "æ•´å½¢æ¸ˆã¿ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‹ã‚‰ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ã‚’æŠ½å‡ºã—ã¦ãã ã•ã„ã€‚"
    }
  ]
}
```

### 3. ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ï¼ˆCapabilitiesï¼‰ã®è¿½åŠ 

#### SharePoint/OneDriveé€£æº

```json
// filepath: appPackage/declarativeAgent.json
{
  // ...existing code...
  "capabilities": [
    {
      "name": "OneDriveAndSharePoint",
      "items_by_url": [
        { "url": "https://contoso.sharepoint.com/sites/MeetingDocs" }
      ]
    }
  ]
}
```

#### Graph Connectorsï¼ˆã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºæ¤œç´¢ï¼‰

```json
// filepath: appPackage/declarativeAgent.json
{
  // ...existing code...
  "capabilities": [
    {
      "name": "GraphConnectors",
      "connections": [
        { "connection_id": "your-connection-id" }
      ]
    }
  ]
}
```

#### Webã‚µã‚¤ãƒˆæ¤œç´¢

```json
// filepath: appPackage/declarativeAgent.json
{
  // ...existing code...
  "capabilities": [
    {
      "name": "WebSearch",
      "allow_list": [
        "https://docs.microsoft.com/*",
        "https://learn.microsoft.com/*"
      ]
    }
  ]
}
```

### 4. APIãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®è¿½åŠ 

å¤–éƒ¨APIã‚’å‘¼ã³å‡ºã™å ´åˆï¼š

```json
// filepath: appPackage/declarativeAgent.json
{
  // ...existing code...
  "actions": [
    {
      "id": "transcriptApi",
      "file": "apiPlugin.json"
    }
  ]
}
```

æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ« `appPackage/apiPlugin.json` ã‚’ä½œæˆã—ã€OpenAPIä»•æ§˜ã§APIã‚’å®šç¾©ã€‚

### 5. æ–°ç’°å¢ƒã®è¿½åŠ ï¼ˆstagingç­‰ï¼‰

1. `env/.env.staging` ã‚’ä½œæˆ
2. `TEAMSFX_ENV=staging` ã‚’è¨­å®š
3. VS Codeã‹ã‚‰ç’°å¢ƒã‚’é¸æŠã—ã¦Provisionå®Ÿè¡Œ

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

| ç—‡çŠ¶ | åŸå›  | å¯¾å‡¦æ³• |
|------|------|--------|
| ãƒ¯ãƒ¼ã‚«ãƒ¼ãŒå‘¼ã³å‡ºã›ãªã„ | Title IDãŒæœªè¨­å®šã¾ãŸã¯ä¸æ­£ | `.env.*` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª |
| ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒè¡¨ç¤ºã•ã‚Œãªã„ | ProvisionãŒæœªå®Œäº† | `Provision` ã‚’å†å®Ÿè¡Œ |
| ã€Œç¶šãã€ã§å‡¦ç†ãŒæ­¢ã¾ã‚‹ | ãƒ¯ãƒ¼ã‚«ãƒ¼ãŒæœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« |

### åˆ¶ç´„äº‹é …

âš ï¸ **ãƒ†ã‚­ã‚¹ãƒˆã®ã¿é€šä¿¡**: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–“ã§ã¯ãƒ•ã‚¡ã‚¤ãƒ«ãƒã‚¤ãƒŠãƒªãƒ»ç”»åƒã¯é€ä¿¡ä¸å¯

âš ï¸ **äº‹å‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¿…é ˆ**: å„ãƒ¯ãƒ¼ã‚«ãƒ¼ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«äº‹å‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦

âš ï¸ **ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½**: Connected Agentsæ©Ÿèƒ½ã¯ç¾åœ¨ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ®µéš

---

## å‚è€ƒãƒªãƒ³ã‚¯

### å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [Declarative agents for Microsoft 365 Copilot](https://learn.microsoft.com/microsoft-365-copilot/extensibility/overview-declarative-agent)
- [Connect to other agents](https://learn.microsoft.com/microsoft-365-copilot/extensibility/declarative-agent-connected-agent)
- [Declarative agent manifest schema v1.6](https://learn.microsoft.com/microsoft-365-copilot/extensibility/declarative-agent-manifest-1.6)
- [App manifest schema v1.24](https://learn.microsoft.com/microsoftteams/platform/resources/schema/manifest-schema)

### ãƒ„ãƒ¼ãƒ«ã‚­ãƒƒãƒˆ

- [Microsoft 365 Agents Toolkit](https://marketplace.visualstudio.com/items?itemName=TeamsDevApp.ms-teams-vscode-extension)
- [CLI (`@microsoft/m365agentstoolkit-cli`)](https://www.npmjs.com/package/@microsoft/m365agentstoolkit-cli)

### ã‚µãƒ³ãƒ—ãƒ«ãƒ»ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«

- [Build declarative agents](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents)
- [Add API plugins](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=7)
## å‚è€ƒãƒªãƒ³ã‚¯

- [Connect to other agents from a declarative agent](https://learn.microsoft.com/microsoft-365-copilot/extensibility/declarative-agent-connected-agent)
- [Declarative agent schema v1.6](https://learn.microsoft.com/microsoft-365-copilot/extensibility/declarative-agent-manifest-1.6)
- [Microsoft 365 Agents Toolkit ã‚¬ã‚¤ãƒ‰](https://github.com/OfficeDev/TeamsFx/wiki/Teams-Toolkit-Visual-Studio-Code-v5-Guide#overview)
- [Add API plugins](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=7) for agent to interact with REST APIs.

## Addition information and references

- [Declarative agents for Microsoft 365](https://aka.ms/teams-toolkit-declarative-agent)
