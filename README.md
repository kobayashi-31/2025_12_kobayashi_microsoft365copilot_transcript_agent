# MTGè­°äº‹éŒ²ãƒãƒ³ - ä»²ä»‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ

Microsoft 365 Copilot ã® **Declarative Agentï¼ˆå®£è¨€å‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼‰** ã¨ **Connected Agentsï¼ˆæ¥ç¶šã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼‰æ©Ÿèƒ½** ã‚’æ´»ç”¨ã—ãŸã€è­°äº‹éŒ²ä½œæˆã®è‡ªå‹•åŒ–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã§ã™ã€‚

---

## ç›®æ¬¡

1. [æ¦‚è¦](#æ¦‚è¦)
2. [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
3. [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ](#ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ)
4. [å„ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²](#å„ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²)
5. [ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †](#ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †)
6. [æ‹¡å¼µæ–¹æ³•](#æ‹¡å¼µæ–¹æ³•)
7. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)
8. [å‚è€ƒãƒªãƒ³ã‚¯](#å‚è€ƒãƒªãƒ³ã‚¯)

---

## æ¦‚è¦

### ã“ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ç›®çš„

ä¼šè­°ã®ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆæ–‡å­—èµ·ã“ã—ï¼‰ã‚’å—ã‘å–ã‚Šã€**ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä»£ã‚ã‚Šã«ã€ŒMTGè­°äº‹éŒ²ãã‚“_V3ã€ã‚’æ“ä½œ**ã—ã¦ã€è­°äº‹éŒ²ã®Markdownã¨Wordãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™ã€‚

### ä¸»ãªç‰¹å¾´

- **å®Œå…¨è‡ªå‹•åŒ–**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ1å›å…¥åŠ›ã™ã‚‹ã ã‘ã§ã€å†…éƒ¨ã§è‡ªå‹•çš„ã«ã€Œç¶šãã€ã€Œè¦ç´„ã—ã¦ã€ã‚’é€ã‚Šã€æœ€çµ‚æˆæœç‰©ã¾ã§å–å¾—
- **ä»²ä»‹ç‰¹åŒ–**: æœ¬ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ç·¨é›†ãƒ»è¦ç´„ã‚’ä¸€åˆ‡è¡Œã‚ãšã€MTGè­°äº‹éŒ²ãã‚“_V3ã®å‡ºåŠ›ã‚’ãã®ã¾ã¾ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¿”ã™
- **2ãƒ¢ãƒ¼ãƒ‰å‡¦ç†**:
  - **Mode A**: ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æ•´å½¢ãƒ»ä¿®å¾©ï¼ˆåˆ†å‰²å‡ºåŠ›ï¼‰
  - **Mode B**: è­°äº‹éŒ²ã®ç”Ÿæˆï¼ˆMarkdown + Wordãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ï¼‰

### Connected Agentsæ©Ÿèƒ½ã¨ã¯

Microsoft 365 Copilotã®æ©Ÿèƒ½ã§ã€**ä»²ä»‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**ãŒ**ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼ˆMTGè­°äº‹éŒ²ãã‚“_V3ï¼‰**ã‚’æ“ä½œã—ã¦å‡¦ç†ã‚’è¡Œã†ä»•çµ„ã¿ã§ã™ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ãƒ¦ãƒ¼ã‚¶ãƒ¼                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      MTGè­°äº‹éŒ²ãƒãƒ³ï¼ˆä»²ä»‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼‰        â”‚
â”‚            æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      MTGè­°äº‹éŒ²ãã‚“_V3ï¼ˆãƒ¯ãƒ¼ã‚«ãƒ¼ï¼‰             â”‚
â”‚                                             â”‚
â”‚  Mode A: æ•´å½¢ãƒ»ä¿®å¾©ï¼ˆåˆ†å‰²å‡ºåŠ›ï¼‰               â”‚
â”‚  Mode B: è­°äº‹éŒ²ç”Ÿæˆï¼ˆMarkdown + Wordï¼‰        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### Declarative Agentï¼ˆå®£è¨€å‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼‰ã®æ§‹é€ 

```
App Package (ZIP)
â”œâ”€â”€ manifest.json           â† Microsoft 365 ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ç™»éŒ²æƒ…å ±
â”œâ”€â”€ declarativeAgent.json   â† ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å‹•ä½œå®šç¾©
â”œâ”€â”€ instruction.txt         â† ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼ˆä»²ä»‹ãƒ­ã‚¸ãƒƒã‚¯ï¼‰
â”œâ”€â”€ color.png              â† ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆã‚«ãƒ©ãƒ¼ç‰ˆï¼‰
â””â”€â”€ outline.png            â† ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ç‰ˆï¼‰
```

### å‡¦ç†ãƒ•ãƒ­ãƒ¼ï¼ˆè‡ªå‹•å®Œèµ°ï¼‰

```mermaid
sequenceDiagram
    participant U as ãƒ¦ãƒ¼ã‚¶ãƒ¼
    participant M as MTGè­°äº‹éŒ²ãƒãƒ³
    participant W as MTGè­°äº‹éŒ²ãã‚“_V3

    U->>M: ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«æ·»ä»˜ + ã€Œæ•´å½¢ã—ã¦ã€
    M->>W: ã€Œæ•´å½¢ã—ã¦ã€
    W-->>M: Mode A å‡ºåŠ›ï¼ˆåˆ†å‰²1ï¼‰+ ã€Œç¶šãã‚’å‡ºåŠ›ã—ã¾ã™ã‹ï¼Ÿã€
    Note over M: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç¢ºèªã›ãšè‡ªå‹•ç¶™ç¶š
    M->>W: ã€Œç¶šãã€
    W-->>M: Mode A å‡ºåŠ›ï¼ˆåˆ†å‰²2ï¼‰+ ã€Œç¶šãã‚’å‡ºåŠ›ã—ã¾ã™ã‹ï¼Ÿã€
    M->>W: ã€Œç¶šãã€
    W-->>M: Mode A å‡ºåŠ›ï¼ˆå®Œäº†ï¼‰+ ã€Œæ•´å½¢ãŒå®Œäº†ã—ã¾ã—ãŸã€
    Note over M: å®Œäº†æ¤œçŸ¥â†’Mode Bèµ·å‹•
    M->>W: ã€Œè¦ç´„ã—ã¦ã€
    W-->>M: Mode B å‡ºåŠ›ï¼ˆMarkdown + Wordãƒªãƒ³ã‚¯ï¼‰
    M-->>U: æœ€çµ‚æˆæœç‰©ã‚’ãã®ã¾ã¾è¿”å´
```

---

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆ/
â”œâ”€â”€ ğŸ“ appPackage/                    # ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®šç¾©ï¼ˆã‚³ã‚¢ï¼‰
â”‚   â”œâ”€â”€ manifest.json                 # ã‚¢ãƒ—ãƒªãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ declarativeAgent.json         # ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè¨­å®š
â”‚   â”œâ”€â”€ instruction.txt               # ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼ˆä»²ä»‹ãƒ­ã‚¸ãƒƒã‚¯ï¼‰
â”‚   â”œâ”€â”€ color.png                     # ã‚«ãƒ©ãƒ¼ã‚¢ã‚¤ã‚³ãƒ³
â”‚   â”œâ”€â”€ outline.png                   # ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ã‚¢ã‚¤ã‚³ãƒ³
â”‚   â””â”€â”€ ğŸ“ build/                     # ãƒ“ãƒ«ãƒ‰æˆæœç‰©ï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰
â”‚
â”œâ”€â”€ ğŸ“ env/                           # ç’°å¢ƒå¤‰æ•°
â”‚   â”œâ”€â”€ .env.local                    # ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç”¨ï¼ˆgitignoreï¼‰
â”‚   â”œâ”€â”€ .env.local.user               # ãƒ­ãƒ¼ã‚«ãƒ«ç”¨ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆï¼ˆgitignoreï¼‰
â”‚   â”œâ”€â”€ .env.dev                      # é–‹ç™ºç’°å¢ƒç”¨
â”‚   â””â”€â”€ .env.dev.user                 # é–‹ç™ºç’°å¢ƒç”¨ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆï¼ˆgitignoreï¼‰
â”‚
â”œâ”€â”€ ğŸ“ .vscode/                       # VS Codeè¨­å®š
â”‚   â”œâ”€â”€ launch.json                   # ãƒ‡ãƒãƒƒã‚°æ§‹æˆ
â”‚   â”œâ”€â”€ tasks.json                    # ã‚¿ã‚¹ã‚¯å®šç¾©
â”‚   â”œâ”€â”€ settings.json                 # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š
â”‚   â”œâ”€â”€ mcp.json                      # MCPã‚µãƒ¼ãƒãƒ¼è¨­å®š
â”‚   â””â”€â”€ extensions.json               # æ¨å¥¨æ‹¡å¼µæ©Ÿèƒ½
â”‚
â”œâ”€â”€ ğŸ“ .github/                       # GitHubè¨­å®š
â”‚   â””â”€â”€ copilot-instructions.md       # GitHub Copilotç”¨æŒ‡ç¤º
â”‚
â”œâ”€â”€ m365agents.yml                    # ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°è¨­å®šï¼ˆé–‹ç™º/æœ¬ç•ªï¼‰
â”œâ”€â”€ m365agents.local.yml              # ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°è¨­å®šï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰
â”œâ”€â”€ .gitignore                        # Gité™¤å¤–è¨­å®š
â””â”€â”€ README.md                         # æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
```

---

## å„ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²

### ğŸ”· `appPackage/manifest.json` - ã‚¢ãƒ—ãƒªãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ

Microsoft 365 ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã¸ã®ã‚¢ãƒ—ãƒªç™»éŒ²æƒ…å ±ã‚’å®šç¾©ã—ã¾ã™ã€‚

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | èª¬æ˜ | æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®š |
|-----------|------|---------------------|
| `$schema` | ã‚¹ã‚­ãƒ¼ãƒãƒãƒ¼ã‚¸ãƒ§ãƒ³ | v1.24 |
| `id` | ã‚¢ãƒ—ãƒªIDï¼ˆç’°å¢ƒå¤‰æ•°ã‹ã‚‰æ³¨å…¥ï¼‰ | `${{TEAMS_APP_ID}}` |
| `name.short` | è¡¨ç¤ºå | MTGè­°äº‹éŒ²ãƒãƒ³ |
| `description` | èª¬æ˜ | ä¼šè­°ã®ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å…¥åŠ›ã‚’å—ã‘å–ã‚Šã€ã€ŒMTGè­°äº‹éŒ²ãã‚“_V3ã€ã«ã‚ˆã£ã¦è­°äº‹éŒ²ã‚’ä½œæˆãƒ»æ•´å½¢ã—ã¾ã™ã€‚ |
| `copilotAgents` | Copilotã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®šç¾© | declarativeAgent.jsonã‚’å‚ç…§ |

```json
{
  "copilotAgents": {
    "declarativeAgents": [{
      "id": "declarativeAgent",
      "file": "declarativeAgent.json"
    }]
  }
}
```

### ğŸ”· `appPackage/declarativeAgent.json` - ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè¨­å®š

ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å‹•ä½œã‚’å®šç¾©ã™ã‚‹ã‚³ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | èª¬æ˜ | æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®š |
|-----------|------|---------------------|
| `$schema` | ã‚¹ã‚­ãƒ¼ãƒãƒãƒ¼ã‚¸ãƒ§ãƒ³ | v1.6 |
| `name` | ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå | MTGè­°äº‹éŒ²ãƒãƒ³ |
| `instructions` | ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ | instruction.txtã‚’å‚ç…§ |
| `conversation_starters` | ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ | ã€ŒMTGè­°äº‹éŒ²ã®æ•´å½¢ã€ã®ã¿ |
| `worker_agents` | æ¥ç¶šã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ | MTGè­°äº‹éŒ²ãã‚“_V3 ã®ã¿ |

```json
{
  "instructions": "$[file('instruction.txt')]",
  "conversation_starters": [
    {
      "title": "MTGè­°äº‹éŒ²ã®æ•´å½¢",
      "text": "æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ•´å½¢ã—ã¦ï¼"
    }
  ],
  "worker_agents": [
    {
      "id": "${{WORKER_AGENT_TITLE_ID}}"
    }
  ]
}
```

### ğŸ”· `appPackage/instruction.txt` - ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ

LLMã¸ã®æŒ‡ç¤ºã‚’è¨˜è¿°ã—ã¾ã™ã€‚æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ä»¥ä¸‹ã‚’å®šç¾©ï¼š

- **å½¹å‰²å®šç¾©**: ã€Œä»²ä»‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã€ã¨ã—ã¦å‹•ä½œï¼ˆç·¨é›†ãƒ»è¦ç´„ã¯ä¸€åˆ‡ã—ãªã„ï¼‰
- **æœ€é‡è¦ãƒ«ãƒ¼ãƒ«**: MTGè­°äº‹éŒ²ãã‚“_V3ã®å‡ºåŠ›ã‚’æ”¹å¤‰ã›ãšã«è¿”ã™
- **åŸºæœ¬ãƒ•ãƒ­ãƒ¼**: ãƒ¦ãƒ¼ã‚¶ãƒ¼1å›å…¥åŠ›ã§è‡ªå‹•å®Œèµ°
  1. **ã‚¹ãƒ†ãƒƒãƒ—1**: ãƒ•ã‚¡ã‚¤ãƒ«æ·»ä»˜ã§ã€Œæ•´å½¢ã—ã¦ã€â†’Mode Aèµ·å‹•
  2. **ã‚¹ãƒ†ãƒƒãƒ—2**: ã€Œç¶šãã‚’å‡ºåŠ›ã—ã¾ã™ã‹ï¼Ÿã€ã‚’æ¤œçŸ¥â†’è‡ªå‹•ã§ã€Œç¶šãã€é€ä¿¡
  3. **ã‚¹ãƒ†ãƒƒãƒ—3**: ã€Œæ•´å½¢ãŒå®Œäº†ã—ã¾ã—ãŸã€ã‚’æ¤œçŸ¥â†’ã€Œè¦ç´„ã—ã¦ã€é€ä¿¡ï¼ˆMode Bèµ·å‹•ï¼‰
  4. **ã‚¹ãƒ†ãƒƒãƒ—4**: Mode Bå‡ºåŠ›ï¼ˆMarkdown + Wordãƒªãƒ³ã‚¯ï¼‰ã‚’ãã®ã¾ã¾ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¿”ã™
- **çŸ­ã„é€ä¿¡ã‚³ãƒãƒ³ãƒ‰**: 
  - é–‹å§‹: `æ•´å½¢ã—ã¦`
  - ç¶™ç¶š: `ç¶šã`
  - è¦ç´„: `è¦ç´„ã—ã¦`
- **ç¦æ­¢äº‹é …**: 
  - ä»²ä»‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè‡ªèº«ãŒè­°äº‹éŒ²ã‚’ä½œæˆã—ãªã„
  - æ•´å½¢ãƒ»ä¿®å¾©ãƒ»è©±è€…æ¨å®šã‚’ã—ãªã„
  - åˆ†å‰²çµæœã‚’çµåˆãƒ»ç·¨é›†ã—ãªã„

### ğŸ”· `env/.env.dev` - ç’°å¢ƒå¤‰æ•°ï¼ˆé–‹ç™ºç’°å¢ƒï¼‰

```env
# ç’°å¢ƒè­˜åˆ¥
TEAMSFX_ENV=dev
APP_NAME_SUFFIX=dev
AGENT_SCOPE=shared

# è‡ªå‹•ç”ŸæˆIDï¼ˆProvisionæ™‚ã«è¨­å®šï¼‰
TEAMS_APP_ID=2f1929bc-b44d-4385-a05b-b94c033a6b29
M365_TITLE_ID=T_a4e6dbd8-42f7-4c05-aabf-e06971d18f5b

# â˜… ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆIDï¼ˆæ‰‹å‹•è¨­å®šãŒå¿…è¦ï¼‰
WORKER_AGENT_TITLE_ID=T_bd14595f-c719-4289-99e8-a469c30fc79c  # MTGè­°äº‹éŒ²ãã‚“_V3
```

### ğŸ”· `m365agents.yml` / `m365agents.local.yml` - ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°è¨­å®š

Infrastructure as Code ã¨ã—ã¦ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †ã‚’å®šç¾©ã—ã¾ã™ã€‚

| ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ | èª¬æ˜ |
|-----------|------|
| `teamsApp/create` | Developer Portalã«ã‚¢ãƒ—ãƒªä½œæˆ |
| `teamsApp/zipAppPackage` | appPackageã‚’ZIPåŒ– |
| `teamsApp/validateAppPackage` | ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ¤œè¨¼ |
| `teamsApp/update` | Developer Portalã«åæ˜  |
| `teamsApp/extendToM365` | Microsoft 365å…¨ä½“ã«å±•é–‹ |
| `teamsApp/publishAppPackage` | ç®¡ç†ã‚»ãƒ³ã‚¿ãƒ¼ã«å…¬é–‹ç”³è«‹ï¼ˆæœ¬ç•ªã®ã¿ï¼‰ |

**ãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆã¨ã®é•ã„:**

| é …ç›® | `m365agents.yml` | `m365agents.local.yml` |
|------|------------------|------------------------|
| `AGENT_SCOPE` | `shared`ï¼ˆçµ„ç¹”å…±æœ‰ï¼‰ | ãªã—ï¼ˆå€‹äººã®ã¿ï¼‰ |
| `publish`ã‚»ã‚¯ã‚·ãƒ§ãƒ³ | ã‚ã‚Š | ãªã— |

---

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### å‰ææ¡ä»¶

- [Node.js](https://nodejs.org/) v18/20/22
- [Microsoft 365 Agents Toolkit](https://marketplace.visualstudio.com/items?itemName=TeamsDevApp.ms-teams-vscode-extension) v5.0.0ä»¥ä¸Š
- [Microsoft 365 Copilot ãƒ©ã‚¤ã‚»ãƒ³ã‚¹](https://learn.microsoft.com/microsoft-365-copilot/extensibility/prerequisites)
- **MTGè­°äº‹éŒ²ãã‚“_V3ï¼ˆäº‹å‰ãƒ‡ãƒ—ãƒ­ã‚¤æ¸ˆã¿ï¼‰**

### æ‰‹é †

#### 1. MTGè­°äº‹éŒ²ãã‚“_V3ã®Title IDå–å¾—

ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã€ŒMTGè­°äº‹éŒ²ãã‚“_V3ã€ã‚’Provisionå¾Œã€ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã§å–å¾—ï¼š

- Provisionå®Ÿè¡Œæ™‚ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›
- `env/.env.*.user` ãƒ•ã‚¡ã‚¤ãƒ«å†…ã® `M365_TITLE_ID`
- [ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼ãƒ¢ãƒ¼ãƒ‰](https://learn.microsoft.com/microsoft-365-copilot/extensibility/debugging-agents-copilot-studio)ã§ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç¢ºèª

#### 2. ç’°å¢ƒå¤‰æ•°è¨­å®š

`env/.env.dev` ã«ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®Title IDã‚’è¨­å®šï¼š

```env
WORKER_AGENT_TITLE_ID=T_xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
```

#### 3. ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°å®Ÿè¡Œ

VS Codeã§:
1. Microsoft 365 Agents Toolkit ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
2. Accountã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã‚µã‚¤ãƒ³ã‚¤ãƒ³
3. `Preview Local in Copilot (Edge)` ã¾ãŸã¯ `(Chrome)` ã‚’å®Ÿè¡Œ

#### 4. ä½¿ç”¨æ–¹æ³•

1. Microsoft 365 Copilotã§ã€ŒMTGè­°äº‹éŒ²ãƒãƒ³ã€ã‚’èµ·å‹•
2. ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆWordãªã©ï¼‰ã‚’æ·»ä»˜
3. ã€Œæ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ•´å½¢ã—ã¦ã€ã¨å…¥åŠ›
4. è‡ªå‹•çš„ã«å‡¦ç†ãŒå®Œèµ°ã—ã€Markdownè­°äº‹éŒ²ã¨Wordãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ãŒè¿”ã•ã‚Œã‚‹

---

## æ‹¡å¼µæ–¹æ³•

### 1. ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®è¿½åŠ 

è¤‡æ•°ã®ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’é€£æºã•ã›ã‚‹å ´åˆï¼š

```json
// appPackage/declarativeAgent.json
{
  "worker_agents": [
    { "id": "${{WORKER_AGENT_TITLE_ID}}" },
    { "id": "${{WORKER_AGENT_2_TITLE_ID}}" }
  ]
}
```

```env
// env/.env.dev
WORKER_AGENT_TITLE_ID=T_bd14595f-c719-4289-99e8-a469c30fc79c
WORKER_AGENT_2_TITLE_ID=T_æ–°ã—ã„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®TitleID
```

### 2. ä¼šè©±ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã®è¿½åŠ 

ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã®ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å¢—ã‚„ã™å ´åˆï¼š

```json
// appPackage/declarativeAgent.json
{
  "conversation_starters": [
    {
      "title": "MTGè­°äº‹éŒ²ã®æ•´å½¢",
      "text": "æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ•´å½¢ã—ã¦ï¼"
    },
    {
      "title": "è³ªç–‘å¿œç­”æŠ½å‡º",
      "text": "Q&Aã‚»ã‚¯ã‚·ãƒ§ãƒ³ã ã‘æŠ½å‡ºã—ã¦ï¼"
    }
  ]
}
```

### 3. ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

`appPackage/instruction.txt` ã‚’ç·¨é›†ã—ã¦ã€ä»²ä»‹ãƒ­ã‚¸ãƒƒã‚¯ã‚’å¤‰æ›´ã§ãã¾ã™ã€‚

**ä¾‹: ä¸­é–“å‡ºåŠ›ã‚‚è¡¨ç¤ºã™ã‚‹å ´åˆ**

```txt
## ã‚¹ãƒ†ãƒƒãƒ—2ï¼šç¶™ç¶šï¼ˆMode Aã®åˆ†å‰²ã‚’æœ€å¾Œã¾ã§ï¼‰
- MTGè­°äº‹éŒ²å›_V3ã®å‡ºåŠ›ã«ã€Œç¶šãã‚’å‡ºåŠ›ã—ã¾ã™ã‹ï¼Ÿã€ãŒå«ã¾ã‚ŒãŸã‚‰ï¼š
  â†’ ãã®å‡ºåŠ›ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¡¨ç¤ºã—ã¦ã‹ã‚‰ã€ã€Œç¶šãã€ã‚’é€ä¿¡
```

### 4. ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ï¼ˆCapabilitiesï¼‰ã®è¿½åŠ 

#### SharePoint/OneDriveé€£æº

```json
// appPackage/declarativeAgent.json
{
  "capabilities": [
    {
      "name": "OneDriveAndSharePoint",
      "items_by_url": [
        { "url": "https://contoso.sharepoint.com/sites/MeetingDocs" }
      ]
    }
  ]
}
```

#### Graph Connectorsï¼ˆã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºæ¤œç´¢ï¼‰

```json
// appPackage/declarativeAgent.json
{
  "capabilities": [
    {
      "name": "GraphConnectors",
      "connections": [
        { "connection_id": "your-connection-id" }
      ]
    }
  ]
}
```

#### Webã‚µã‚¤ãƒˆæ¤œç´¢

```json
// appPackage/declarativeAgent.json
{
  "capabilities": [
    {
      "name": "WebSearch",
      "allow_list": [
        "https://docs.microsoft.com/*",
        "https://learn.microsoft.com/*"
      ]
    }
  ]
}
```

### 5. APIãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®è¿½åŠ 

å¤–éƒ¨APIã‚’å‘¼ã³å‡ºã™å ´åˆï¼š

```json
// appPackage/declarativeAgent.json
{
  "actions": [
    {
      "id": "transcriptApi",
      "file": "apiPlugin.json"
    }
  ]
}
```

æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ« `appPackage/apiPlugin.json` ã‚’ä½œæˆã—ã€OpenAPIä»•æ§˜ã§APIã‚’å®šç¾©ã€‚

### 6. æ–°ç’°å¢ƒã®è¿½åŠ ï¼ˆstagingç­‰ï¼‰

1. `env/.env.staging` ã‚’ä½œæˆ
2. `TEAMSFX_ENV=staging` ã‚’è¨­å®š
3. VS Codeã‹ã‚‰ç’°å¢ƒã‚’é¸æŠã—ã¦Provisionå®Ÿè¡Œ

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

| ç—‡çŠ¶ | åŸå›  | å¯¾å‡¦æ³• |
|------|------|--------|
| MTGè­°äº‹éŒ²ãã‚“_V3ãŒå‘¼ã³å‡ºã›ãªã„ | Title IDãŒæœªè¨­å®šã¾ãŸã¯ä¸æ­£ | `.env.*` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª |
| ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒè¡¨ç¤ºã•ã‚Œãªã„ | ProvisionãŒæœªå®Œäº† | `Provision` ã‚’å†å®Ÿè¡Œ |
| ã€Œç¶šãã€ã§å‡¦ç†ãŒæ­¢ã¾ã‚‹ | ãƒ¯ãƒ¼ã‚«ãƒ¼ãŒæœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«MTGè­°äº‹éŒ²ãã‚“_V3ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« |
| è‡ªå‹•ç¶™ç¶šã—ãªã„ | ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œçŸ¥ãŒå¤±æ•— | instruction.txtã®æ¤œçŸ¥æ¡ä»¶ã‚’ç¢ºèª |
| Wordãƒªãƒ³ã‚¯ãŒè¿”ã•ã‚Œãªã„ | Mode Bèµ·å‹•ã«å¤±æ•— | ã€Œæ•´å½¢ãŒå®Œäº†ã—ã¾ã—ãŸã€æ¤œçŸ¥ã‚’ç¢ºèª |
| Color Iconã‚¨ãƒ©ãƒ¼ | ã‚¢ã‚¤ã‚³ãƒ³ã‚µã‚¤ã‚ºãŒä¸æ­£ | color.pngã‚’192x192ãƒ”ã‚¯ã‚»ãƒ«ã«å¤‰æ›´ |
| Full descriptionã®è­¦å‘Š | shortã¨fullãŒåŒã˜å†…å®¹ | manifest.jsonã®full descriptionã‚’è©³ç´°åŒ– |

### åˆ¶ç´„äº‹é …

âš ï¸ **ãƒ†ã‚­ã‚¹ãƒˆã®ã¿é€šä¿¡**: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–“ã§ã¯ãƒ•ã‚¡ã‚¤ãƒ«ãƒã‚¤ãƒŠãƒªãƒ»ç”»åƒã¯é€ä¿¡ä¸å¯

âš ï¸ **äº‹å‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¿…é ˆ**: MTGè­°äº‹éŒ²ãã‚“_V3ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«äº‹å‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦

âš ï¸ **ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½**: Connected Agentsæ©Ÿèƒ½ã¯ç¾åœ¨ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ®µéš

âš ï¸ **å˜ä¸€ãƒ¯ãƒ¼ã‚«ãƒ¼è¨­è¨ˆ**: æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯MTGè­°äº‹éŒ²ãã‚“_V3å°‚ç”¨ã®ä»²ä»‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ

---

## å‚è€ƒãƒªãƒ³ã‚¯

### å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [Declarative agents for Microsoft 365 Copilot](https://learn.microsoft.com/microsoft-365-copilot/extensibility/overview-declarative-agent)
- [Connect to other agents](https://learn.microsoft.com/microsoft-365-copilot/extensibility/declarative-agent-connected-agent)
- [Declarative agent manifest schema v1.6](https://learn.microsoft.com/microsoft-365-copilot/extensibility/declarative-agent-manifest-1.6)
- [App manifest schema v1.24](https://learn.microsoft.com/microsoftteams/platform/resources/schema/manifest-schema)

### ãƒ„ãƒ¼ãƒ«ã‚­ãƒƒãƒˆ

- [Microsoft 365 Agents Toolkit](https://marketplace.visualstudio.com/items?itemName=TeamsDevApp.ms-teams-vscode-extension)
- [CLI (`@microsoft/m365agentstoolkit-cli`)](https://www.npmjs.com/package/@microsoft/m365agentstoolkit-cli)

### ã‚µãƒ³ãƒ—ãƒ«ãƒ»ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«

- [Build declarative agents](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents)
- [Add API plugins](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=7)
- [Microsoft 365 Agents Toolkit ã‚¬ã‚¤ãƒ‰](https://github.com/OfficeDev/TeamsFx/wiki/Teams-Toolkit-Visual-Studio-Code-v5-Guide#overview)
